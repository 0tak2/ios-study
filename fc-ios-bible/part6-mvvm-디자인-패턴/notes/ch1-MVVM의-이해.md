# MVVM의 이해

## 도입 이유

- 기존의 MVC 패턴
  - 개념 상 실질적인 비즈니스 로직을 담당하는 모델과, 화면 단을 담당하는 뷰, 그리고 그 사이의 뷰 컨트롤러가 일정의 책임을 가지고 있기는 함
    
    ```
     (KVO) - - - ->  ViewController <- - - -  (User Interaction)
          /       / (owns)    (owns) \       \
    Model <-------                    --------> View
    ```

  - 다만 실제로 구현할 때 뷰와 뷰 컨트롤러는 거의 분리되지 않음
  - 즉, 실질적으로는 아래와 비슷함
    
    ```
                            -----owns----->
    [View | ViewController] --------------- [Model]
                            < - -updates- - 
    ```
  - 이에 따라 뷰 컨틀롤러에 책임이 집중됨
    - 프레젠테이션 로직
    - 비즈니스 로직
    - 데이터 접근 로직
    - ...
  - => **M**assive **V**iew**C**ontroller
    - 유지보수의 어려움
    - 직접 모델에 접근하고 화면도 업데이트 -> 버그

## 개선 - ViewModel의 도임

- ViewController는 뷰단의 일부로 본다
  - View 레이어의 책임
   - 데이터를 화면에 표현
   - 사용자의 인터랙션을 받아 전달
- 뷰단에서 모델에 직접 접근하지 말고, 원본의 모델을 뷰에서 사용하도록 알맞게 가공된 상태로 제공하는, 이름하여 ViewModel을 도입한다
  - AS-IS: 모델의 Date 프로퍼티를 뷰컨트롤러에서 직접 접근해 로컬에 맞게 String으로 가공해 화면에 표시
  - TO-BE: 모델의 Date 프로퍼티는 뷰모델에서 이미 알맞는 형태의 String으로 가공해두고 이 데이터만을 뷰컨트롤러에 제공. 뷰컨트롤러에서는 화면 표시만 수행.
  - \* 뷰 컨트롤러에는 네트워크 서비스, DB 레포지토리를 직접 접근하지 않고, 뷰 모델을 통해서 필요한 데이터 타입으로만 가져올 수 있음.

## MVVM 개괄

```
                        -----owns----->             -----owns----->
[View | ViewController] --------------- [ViewModel] --------------- [Model]
                        < - -updates- -             < - -updates- -
```

- 뷰 컨트롤러는 뷰 모델을 소유한다.
- 뷰 모델은 모델을 소유한다.
- 뷰 모델의 역할
  1. Data -> Output
    - 뷰에 적용할 수 있는 형태로 모델 데이터를 가공해 제공
  2. User Action -> Input
    - 사용자 인텐트에 대한 처리
    - 뷰가 알려온 사용자 액션에 대한 비즈니즈 로직 처리
